<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë¦¬ë·° ìƒì„¸ ë³´ê¸°</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="iphone-frame">
    <div class="dynamic-island">
      <div class="time" id="currentTime">12:00</div>
      <div class="island"></div>
      <div class="status-icons">
        <img src="{{ url_for('static', filename='doc.png') }}" alt="status icons" class="status-img">
      </div>
    </div>

    <div class="app-screen">
      <h2>{{ review.title }}</h2>
      <p><strong>ì‘ì„±ì:</strong> {{ review.user }} | {{ review.timestamp }}</p>
      <p><strong>í…Œë§ˆ:</strong> {{ review.theme }}</p>
      <p>{{ review.content }}</p>

      {% if review.image %}
        <img src="{{ url_for('static', filename=review.image) }}" alt="ë¦¬ë·° ì´ë¯¸ì§€" class="review-img">
      {% endif %}

      <!-- ì¢‹ì•„ìš” -->
      <form method="post" action="{{ url_for('like_review', review_id=review.doc_id) }}">
        <button type="submit">ğŸ‘ğŸ» ì¢‹ì•„ìš” {{ review.likes or 0 }}</button>
      </form>

      <!-- ëŒ“ê¸€ ì‘ì„± -->
      {% if session.get('user_id') %}
      <form method="post" action="{{ url_for('add_comment', review_id=review.doc_id) }}">
        <input type="text" name="comment" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”" required class="input-box">
        <button type="submit">ëŒ“ê¸€ ì‘ì„±</button>
      </form>
      {% endif %}

      <!-- ëŒ“ê¸€ ëª©ë¡ -->
      {% if review.comments %}
        <div class="comments">
          <p><strong>ëŒ“ê¸€ ëª©ë¡:</strong></p>
          <ul>
            {% for comment in review.comments %}
              <li>
                <strong>{{ comment.user }}</strong>: {{ comment.text }}
                <span style="font-size: 0.85em; color: gray;">({{ comment.timestamp }})</span>

                {% if session.get('user_id') and comment.user == current_user %}
                  <form method="get" action="{{ url_for('edit_comment', review_id=review.doc_id, comment_id=comment.id) }}" style="display:inline;">
                    <button type="submit">âœï¸</button>
                  </form>
                  <form method="post" action="{{ url_for('delete_comment', review_id=review.doc_id, comment_id=comment.id) }}" style="display:inline;">
                    <button type="submit">ğŸ—‘</button>
                  </form>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <!-- ë¦¬ë·° ìˆ˜ì • ë° ì‚­ì œ ë²„íŠ¼ (ì‘ì„±ìì—ê²Œë§Œ í‘œì‹œ) -->
      {% if session.get('user_id') and review.user == current_user %}
        <form method="get" action="{{ url_for('edit_review', review_id=review.doc_id) }}">
          <button type="submit">âœï¸ ë¦¬ë·° ìˆ˜ì •</button>
        </form>
        <form method="post" action="{{ url_for('delete_review', review_id=review.doc_id) }}">
          <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ğŸ—‘ ë¦¬ë·° ì‚­ì œ</button>
        </form>
      {% endif %}

      <a href="{{ url_for('review') }}">â† ë¦¬ë·° ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <div class="home-indicator"></div>
  </div>

  <script>
    function updateTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      document.getElementById('currentTime').textContent = `${hours}:${minutes}`;
    }
    setInterval(updateTime, 1000);
    updateTime();
  </script>
</body>
</html>
