<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>여행지 검색</title>
  <!-- Flask를 위해 수정 (CSS 연결)-->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="iphone-frame">
    <div class="dynamic-island">
      <div class="time" id="currentTime">12:00</div>
      <div class="island"></div>
      <div class="status-icons">
       <img src="{{ url_for('static', filename='doc.png') }}" alt="status icons" class="status-img">
      </div>
    </div>

    <div class="app-screen">
      {% with messages = get_flashed_messages() %}
        {% if messages %}
          <script>
            alert("{{ messages[-1] }}");
          </script>
        {% endif %}
      {% endwith %}
      <a href="{{ url_for('index') }}" class="logo-text-center">TripPick</a>

      <div class="back-section">
        <img src="{{ url_for('static', filename='back-arrow.png') }}" alt="뒤로가기" class="back-icon" onclick="history.back()" />
        <span class="page-title-left">상세 페이지</span>
      </div>
      <!-- <h2>상세 페이지</h2> -->
      <!--사진, 제목, 전화번호, 주소(카카오맵), 현재날씨와 예보(meteo-api), 특산물, 숙박 정보-->

      <!-- 상세정보 출력 (임시로 디자인 X)-->
      {% if info %}
        <h3>{{ info.title }}</h3>
        {% if info.item_addr1 %}
          <p>📍 {{ info.item_addr1 }}</p>
        {% endif %}
        {% if info.tel %}
          <p>☎️ {{ info.tel }}</p>
        {% endif %}
        {% if info.image %}
          <p><img src="{{ info.image }}" alt="{{ info.title }}" class="place-image"></p>
        {% else %}
          <div class="place-image-placeholder">이미지 없음</div>
        {% endif %}
      {% endif %}
      <p>태그</p>
      {% if keywords %}
        <p>
          <ul>
            {% for tag in keywords[:3] %}
              <li>#{{ tag }}</li>
            {% endfor %}
          </ul>
        </p>
      {% endif %}

      <p>이 지역의 특산물 목록</p>
      {% if items2 %}
        <p>
          <ul>
            {% for item in items2 %}
              <li>{{ item.cntntsSj }}</li>
            {% endfor %}
          </ul>
        </p>
      {% endif %}

      <h3>리뷰</h3>
      {% if session.get('user_id') %}
      <form action="{{ url_for('detail') }}?item_addr1={{ info.item_addr1 }}&contentid={{ info.contentid }}&image={{ info.image }}&title={{ info.title }}&tel={{ info.tel }}"
            method="post" enctype="multipart/form-data">
        <label for="title">제목:</label><br>
        <input type="text" id="title" name="title" required><br><br>
        <label for="content">내용:</label><br>
        <textarea id="content" name="content" rows="3" required></textarea><br><br>
        <label for="theme">테마:</label><br>
        <select id="theme" name="theme">
          <option value="힐링">힐링</option>
          <option value="액티비티">액티비티</option>
          <option value="사진명소">사진명소</option>
          <option value="먹거리">먹거리</option>
          <option value="기타">기타</option>
        </select><br><br>
        <label for="image">사진 첨부:</label><br>
        <input type="file" id="image" name="image" accept="image/*"><br><br>
        <button type="submit">리뷰 작성</button>
      </form>
      {% else %}
      <p>리뷰를 작성하려면 로그인 해주세요. <a href="{{ url_for('login') }}">로그인</a></p>
      {% endif %}

      {% if reviews %}
      <ul class="place-review-list">
        {% for review in reviews %}
          <li class="place-review-item">
            <h4>{{ review.title }}</h4>
            <p>{{ review.content }}</p>
            <p>작성자: {{ review.user }} | {{ review.timestamp }}</p>
            <a href="{{ url_for('review_detail', review_id=review.doc_id) }}">리뷰 상세</a>
          </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>아직 등록된 리뷰가 없습니다.</p>
      {% endif %}

      <!-- Flask 연동 -->
      <a href="{{ url_for('index') }}" class="app">홈으로</a>
      <!-- <button class="app" onclick="navigate('index.html')">홈으로</button> -->
    </div>

    <div class="home-indicator"></div>
  </div>

  <script>
    function navigate(page) {
      window.location.href = page;
    }
    function updateTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      document.getElementById('currentTime').textContent = `${hours}:${minutes}`;
    }
    setInterval(updateTime, 1000);
    updateTime();
  </script>
</body>
</html>
